计算机中只有0101

人为的约定  
65=》A
66=》B
...
...

2进制编码到字符的映射 就是字符集

1111 1111
0000 0000
256种值

一个字节八位就足够了
事实上，7个位就够了。因为7个位，可以表示128种变化

ascii
0-127 来表示

0xxx xxxx 最高位始终是0

中国
常用汉字3000多，生僻汉字不用说

1个字节够不够，需要用2个字节表示
共65535种可能，够用


GB2312字符集

[202 197] 假如代表 中
[69 197]  代表？ 69和197整个理解，还是单个理解
[200 101]

202 197 69 197 200 101 ....

69和197整个理解还是单理解成E
歧义：就是因为单字节小于127的值，正好是ascii的值
如果严格的2字节绑定，理解为中文
则gb2312不能理解英文

所有字符集兼容ascii

问：如何兼容ascii，又能双字节表示中文
ascii再0-127 之间
0xxx xxxx
干脆gb2312 完全不占用0-127

我的组合来自于
[129-255][129-255]

130 140 97 95 134 198
答：能看出几个英文
中文字母字母中文

但是，中文的组合数也少了
只能10000+
事实上，GB2312只能容纳6000多字


GBK编码出现  完全兼容GB2312

GBK还是双字节，如何扩充容量
GBK的第二个字节，低位，不再局限于129到255，<127 也能用
碰到>128的，就再往后找一字节，2字节理解成中文，继续找
第二字节第一部分领域在40-7E

其他领域在80-FE


unicode（统一码，万国码，单一码），是一种在计算机上使用的字符编码，它位每种语言的美俄字符设定了统一并且唯一的二进制编码，以满足跨语言跨平台进行文本转换处理的要求

用四个字节来编号
2^32 40亿  足够用

但是我们常用的，集中在前65535个标号里，2个字节就够了

unicode只负责分配编号，而且都用四个字节分配编号

你负责编号，我负责在不改变你编号的基础上，简化字节

Unicode的实现方式称为Unicode转换格式简称UTF

例如:如果一个仅包含基本7位ASCII字符的Unicode文件，如果每个字节都用2字节的原Unicode编码传输，其第一个字节的8位始终为0.这就造成了比较大的浪费。
对于这种情况，可以使用utf-8编码，这是一种变长编码，它将基本的7位ASCII字符仍用7位编码表示，占用一个字节，首位补0，而遇到与其他Unicode字符混合的情况，将按一定算法转换，每个字符使用1-3个字节编码。

Unicode与UTF-8的关系
就像原文件 =》 压缩文件的关系


UTF-8占用几个字节？
不可能定长。否则压缩无意义
变长，1-6字节，如何确定字符边界

![](http://ww1.sinaimg.cn/large/005Lei8Jgy1g9s1ch7tqjj30ej082q69.jpg)

最高位有几个1就是几个字节
|最高位为|字节|
|:--:|:--:|
|0|1个字节|
|110|2个字节|
|1110|3个字节|
|11110|4个字节|
|111110|5个字节|
|1111110|6个字节|


如何截取utf8（各国语言都有），无乱码?
从头开始，取一个字节
通过位运算，计算连续的1的个数
如为0，则截取1个字节
如为N，则截取N个字节

从容量上来看
GB2312 < GBK < UTF-8

问：GBK中文经常在java中，被转为UTF-8，怎么转的？
GBK也是和unicode有对应关系的
GBK -》unicode -》utf-8

乱码原因?
解码时与实际编码不一致  （可修复）
传输过程中，编码不一致，导致字节丢失（不可修复）

ANSI    与操作系统字符集一致   在国内对应GBK

连接器特性：连接客户端和服务器
客户端字符先发给连接器
连接器选择一种编码将其转换，临时存储
再次转换成服务器需要的编码，并存储在服务器

![](http://ww1.sinaimg.cn/large/005Lei8Jly1g9uwkukofqj30gi07576h.jpg)

要想不乱码，需要指定客户端的编码，让连接器不理解错误，这样既不会存入错误数据
往回取得时候，我们还要告诉连接器，如果你从服务返回，应该给我转什么格式
一共三个参数，客户端发送的编码，连接器使用的编码，获取的返回数据的编码

当前的情景，客户端GBK，服务器最终存UTF-8
明确告诉服务器
我的客户端是GBK
set chatacter_set_client=GBK

再告诉连接器使用UTF8
set chatacter_set_connection=utf8

最后告诉如果返回值，请返回GBK的结果
set character_set_resulte=gbk;

注：服务器>=connection>=client   否则会出现乱码
如果三者都是GBK，可以简写 set names gbk;

因此，牵涉到数据库，想不乱码
1、正确制定客户端编码
2、合理选择连接器编码
3、正确制定返回内容编码

网页文件本身编码，meta信息，client/connection/result的指定都保持一致，无乱码可能

utf8的bom问题
默认ansi GBK
联通
C1 AA CD A8

utf8
EF BB EF E8 81 9 





